From 4f5e32e40f119b840f7e622cecf6029bb034ed21 Mon Sep 17 00:00:00 2001
From: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
Date: Wed, 10 Sep 2014 11:48:23 +0200
Subject: [PATCH 23/31] bluetooth: Add discovery to pa_bluetooth_backend_new

---
 src/modules/bluetooth/backend-null.c | 2 +-
 src/modules/bluetooth/bluez5-util.c  | 2 +-
 src/modules/bluetooth/bluez5-util.h  | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/src/modules/bluetooth/backend-null.c b/src/modules/bluetooth/backend-null.c
index f8a145b..6e621a7 100644
--- a/src/modules/bluetooth/backend-null.c
+++ b/src/modules/bluetooth/backend-null.c
@@ -27,7 +27,7 @@
 
 #include "bluez5-util.h"
 
-pa_bluetooth_backend *pa_bluetooth_backend_new(pa_core *c) {
+pa_bluetooth_backend *pa_bluetooth_backend_new(pa_core *c, pa_bluetooth_discovery *y) {
     pa_log_debug("Bluetooth Headset Backend API support disabled");
     return NULL;
 }
diff --git a/src/modules/bluetooth/bluez5-util.c b/src/modules/bluetooth/bluez5-util.c
index ca39318..2967e24 100644
--- a/src/modules/bluetooth/bluez5-util.c
+++ b/src/modules/bluetooth/bluez5-util.c
@@ -896,7 +896,7 @@ static void get_managed_objects_reply(DBusPendingCall *pending, void *userdata)
     y->objects_listed = true;
 
     if (!y->backend)
-        y->backend = pa_bluetooth_backend_new(y->core);
+        y->backend = pa_bluetooth_backend_new(y->core, y);
 
 finish:
     dbus_message_unref(r);
diff --git a/src/modules/bluetooth/bluez5-util.h b/src/modules/bluetooth/bluez5-util.h
index d41bf28..8db4a17 100644
--- a/src/modules/bluetooth/bluez5-util.h
+++ b/src/modules/bluetooth/bluez5-util.h
@@ -106,7 +106,7 @@ struct pa_bluetooth_adapter {
     bool valid;
 };
 
-pa_bluetooth_backend *pa_bluetooth_backend_new(pa_core *c);
+pa_bluetooth_backend *pa_bluetooth_backend_new(pa_core *c, pa_bluetooth_discovery *y);
 void pa_bluetooth_backend_free(pa_bluetooth_backend *b);
 
 pa_bluetooth_transport *pa_bluetooth_transport_new(pa_bluetooth_device *d, const char *owner, const char *path,
-- 
1.9.3

